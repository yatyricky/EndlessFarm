function InitGlobals()
end

function InitCustomPlayerSlots()
    SetPlayerStartLocation(Player(0), 0)
    SetPlayerColor(Player(0), ConvertPlayerColor(0))
    SetPlayerRacePreference(Player(0), RACE_PREF_HUMAN)
    SetPlayerRaceSelectable(Player(0), true)
    SetPlayerController(Player(0), MAP_CONTROL_USER)
end

function InitCustomTeams()
    SetPlayerTeam(Player(0), 0)
end

function main()
    SetCameraBounds(-3328.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), -3584.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM), 3328.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), 3072.0 - GetCameraMargin(CAMERA_MARGIN_TOP), -3328.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), 3072.0 - GetCameraMargin(CAMERA_MARGIN_TOP), 3328.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), -3584.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM))
    SetDayNightModels("Environment\\DNC\\DNCLordaeron\\DNCLordaeronTerrain\\DNCLordaeronTerrain.mdl", "Environment\\DNC\\DNCLordaeron\\DNCLordaeronUnit\\DNCLordaeronUnit.mdl")
    NewSoundEnvironment("Default")
    SetAmbientDaySound("LordaeronSummerDay")
    SetAmbientNightSound("LordaeronSummerNight")
    SetMapMusic("Music", true, 0)
    InitBlizzard()
    InitGlobals()
--nef-inject
local a={}local b=function(c)local d=a[c]if d~=nil then if not d.inited then d.cached=d.loader()d.inited=true end;return d.cached else error("module not found")return nil end end;a["Main"]={inited=false,cached=false,loader=function(...)b("Game/Configs/Const")b("GlobalFuncs")b("TableExt")b("Logger")b("Time").Init()b("Game/Engine").Start()end}a["Game/Configs/Const"]={inited=false,cached=false,loader=function(...)ATT_STR=1;ATT_AGI=2;ATT_INT=3;ATT_NON=4;CAREER_TYPE_TANK=32;CAREER_TYPE_HEALER=2;CAREER_TYPE_DPS=4;CAREER_TYPE_MINION=64;CAREER_TYPE_BOSS=8;CAREER_TYPE_CREEP=16 end}a["GlobalFuncs"]={inited=false,cached=false,loader=function(...)function clone(e)local f={}local function g(e)if type(e)~="table"then return e elseif f[e]then return f[e]end;local h={}f[e]=h;for i,j in pairs(e)do h[g(i)]=g(j)end;return setmetatable(h,getmetatable(e))end;return g(e)end;function class(k,l)local m=type(l)local n;if m~="function"and m~="table"then m=nil;l=nil end;if m=="function"or l and l.__ctype==1 then n={}if m=="table"then for o,p in pairs(l)do n[o]=p end;n.__create=l.__create;n.super=l else n.__create=l end;n.Constructor=function()end;n.__cname=k;n.__ctype=1;function n.New(...)local q=n.__create(...)for o,p in pairs(n)do q[o]=p end;q.class=n;q:Constructor(...)return q end else if l then n=clone(l)n.super=l else n={Constructor=function()end}end;n.__cname=k;n.__ctype=2;n.__index=n;function n.New(...)local q=setmetatable({},n)q.class=n;q:Constructor(...)return q end end;return n end;function bindfunc(r,s)return function(...)return r(s,...)end end end}a["TableExt"]={inited=false,cached=false,loader=function(...)function t_join(t,u,v)local w=""for x=1,#t do if v then w=w..v(t[x])else w=w..tostring(t[x])end;if x<#t then w=w..u end end;return w end;function t_isempty(t)return next(t)==nil end;function t_tojson(t,y)local function z(A)local B=type(A)if B=="string"then return'"'..A..'"'end;local C=tostring(A)if B=="function"then return'"'..C..'"'else return C end end;local function D(t,E,F,G)if type(t)~="table"then return z(t)end;G=G or{}local H=tostring(t)if G[H]then return'"_ ref '..H..'"'end;G[H]=true;local I="{"if E then I=I.."\n"end;local J=E or""local K=y or""local L=E and J..K or nil;local M=E and" "or""I=I..J..'"_ ":'..M..'"'..H..'"'for o,p in pairs(t)do if E then I=I..",\n"else I=I..","end;local N;if type(o)=="number"then N="_ "..o else N=tostring(o)end;I=I..J..'"'..N..'":'..M..D(p,L,E,G)end;if E then I=I.."\n"..(F or"")end;I=I.."}"return I end;return D(t,y)end;function t_query(O,P)P=P or{}local Q=P.asList;local R=P.where;local S=P.select;local T=P.any;local U=P.all;local V=S or T==nil and U==nil;local W={}local i;local j;for o,p in pairs(O)do if R then if R(o,p)then if V then if Q then i=#W+1 else i=o end;if S then j=S(o,p)else j=p end;W[i]=j else if T then if T(o,p)then return true end elseif U then if not U(o,p)then return false end end end end else if V then if Q then i=#W+1 else i=o end;if S then j=S(o,p)else j=p end;W[i]=j else if T then if T(o,p)then return true end elseif U then if not U(o,p)then return false end end end end end;if V then return W else if T then return false elseif U then return true end end end;t_insert=table.insert end}a["Logger"]={inited=false,cached=false,loader=function(...)local X=b("Time")function log(...)local I=""for Y,p in pairs({...})do I=I.." "..t_tojson(p)end;print(X.GetTime().."[I]:"..I)end;function logwarn(...)print(X.GetTime().."[W]:",...)end;function logerror(...)print(X.GetTime().."[E]:",...)end end}a["Time"]={inited=false,cached=false,loader=function(...)local X={}local Z=100;function X.Init()X.clock=CreateTimer()X.time=0;TimerStart(X.clock,Z,true,function()X.time=X.time+Z end)end;function X.GetTime()return X.time+TimerGetElapsed(X.clock)end;function X.GetTimeHMS()local _=GetGameTime()local t={}local a0=math.floor(_)_=_-a0;t.h=math.floor(a0/3600)a0=a0-t.h*3600;t.m=math.floor(a0/60)a0=a0-t.m*60;t.s=a0+_;return t end;return X end}a["Game/Engine"]={inited=false,cached=false,loader=function(...)local X=b("Time")local a1=b("Timer")local a2=b("Game/World")local a3={}function a3.Start()local a4=a2.New()a4:Add(b("Game/Systems/TestSystem").New())a4:Add(b("Game/Systems/SpellCastSystem").New())a4:Awake()a4:Start()local a5=X.GetTime()local a6=a1.New(0.01666667,-1,function()local a7=X.GetTime()a4:Update(a7-a5)a5=a7 end):Start()end;return a3 end}a["Timer"]={inited=false,cached=false,loader=function(...)local a1=class("Timer")a1.refs={}function a1.Update()local a8=a1.refs[GetExpiredTimer()]if a8.this then a8.callback(a8.this)else a8.callback()end;a8.cloop=a8.cloop-1;if a8.cloop<=0 then a1.Destroy(a8)end end;function a1:Constructor(a9,aa,ab,a8)self.interval=a9;self.loop=aa;self.cloop=self.loop;self.callback=ab;self.this=a8;self.nTimer=CreateTimer()a1.refs[self.nTimer]=self end;function a1:Start()TimerStart(self.nTimer,self.interval,true,a1.Update)return self end;function a1:Extend(j,ac)ac=ac or false;local w=j;if not ac then w=math.floor(j/self.interval)end;self.cloop=self.cloop+w end;function a1:Pause()end;function a1:Resume()end;function a1:Destroy()a1.refs[self.nTimer]=nil;DestroyTimer(self.nTimer)end;return a1 end}a["Game/World"]={inited=false,cached=false,loader=function(...)local a2=class("World")function a2:Constructor()self:Init()end;function a2:Init()self.systems={}self.time=0 end;function a2:Add(ad)t_insert(self.systems,ad)end;function a2:Awake()for Y,p in pairs(self.systems)do p:Awake()end end;function a2:Start()for Y,p in pairs(self.systems)do p:Start()end end;function a2:Update(ae)self.time=self.time+ae;for Y,p in pairs(self.systems)do p:Update(ae)end end;return a2 end}a["Game/Systems/TestSystem"]={inited=false,cached=false,loader=function(...)local af=b("Game/System")local a1=b("Timer")local ag=class("TestSystem",af)function ag:Awake()end;function ag:Start()self.counter=1;self.t=a1.New(0.7,1,self.Callback,self):Start()end;function ag:Update(ah)end;function ag:Callback()log("definite timer called",self.counter)end;return ag end}a["Game/System"]={inited=false,cached=false,loader=function(...)local af=class("System")function af:Awake()end;function af:Start()end;function af:Update(ae)end;return af end}a["Game/Systems/SpellCastSystem"]={inited=false,cached=false,loader=function(...)local af=b("Game/System")local ai=b("Game/EventCenter")local aj=class("SpellCastSystem",af)function aj:Awake()ai.SpellCast:AddListener(self.OnSpellCast,self)end;function aj:OnSpellCast(ak,al)log(GetUnitName(ak).." cast "..al)end;return aj end}a["Game/EventCenter"]={inited=false,cached=false,loader=function(...)local am=b("Event")local an=0;local function ao()an=an+1;return an end;return{SpellCast=am.New(ao())}end}a["Event"]={inited=false,cached=false,loader=function(...)local am=class("Event")function am:Constructor(an)self.id=an;self.handlers={}end;function am:AddListener(ap,s)if self.handlers[ap]then logwarn("double AddListener ",self.id,ap,s)end;self.handlers[ap]=s or false end;function am:RemoveListener(ap)if ap then if not self.handlers[ap]then logwarn("no hander in event ",self.id,ap)end;self.handlers[ap]=nil else self.handlers={}end end;function am:Broadcast(...)local aq=0;for ap,s in pairs(self.handlers)do if s then ap(s,...)else ap(...)end;aq=aq+1 end;if aq==0 then log("event "..self.id.." has no listener")end end;return am end}a["Main"].loader()
--nef-inject-end
end

function config()
    SetMapName("TRIGSTR_001")
    SetMapDescription("TRIGSTR_003")
    SetPlayers(1)
    SetTeams(1)
    SetGamePlacement(MAP_PLACEMENT_USE_MAP_SETTINGS)
    DefineStartLocation(0, 576.0, -576.0)
    InitCustomPlayerSlots()
    SetPlayerSlotAvailable(Player(0), MAP_CONTROL_USER)
    InitGenericPlayerSlots()
end

